<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ejemplo WebStorage</title>
</head>
<body>

<h2>Ejemplo de WebStorage API</h2>
<p>
    Ver información utilizando la herramienta de desarrollador del navegador.
</p>
<p id="primeraVez">....</p>
<p id="ultimaVez">....</p>
<script>

    function manejadorPersistencia(event) {
        console.log("Evento: "+event)
        if (event.newValue === null) { // it was removed
            // Do somthing
        } else {
            // Do somthing else
        }
    }

    window.addEventListener('storage', manejadorPersistencia, false);

    //Guardando la información en el local.
    var primerAcceso = localStorage.getItem("fechaAcceso");
    if(primerAcceso == null) {
        var tmp = new Date().toUTCString();
        localStorage.setItem("fechaAcceso", tmp); //Siempre guarda
        primerAcceso = tmp;
    }

    //Almacenando información en el ambiente de sesión.
    sessionStorage.setItem("fechaAcceso", new Date().toUTCString());

    //Mostrando.
    document.getElementById("primeraVez").innerText ="La primera vez accedido: "+primerAcceso;
    document.getElementById("ultimaVez").innerText ="La última  vez accedido: "+sessionStorage.getItem("fechaAcceso");

</script>
</body>
</html>